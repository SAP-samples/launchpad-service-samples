{
	"title": "JSON schema for SAP HANA Cloud HTML5 application descriptor neo-app.json",
	"$schema": "http://json-schema.org/draft-04/schema#",

	"description": "The HTML5 application descriptor describes the server side runtime behavior of HTML5 applications running on the SAP HANA Cloud Platform",

	"type": "object",
	"additionalProperties": false,
	"properties": { 
		"authenticationMethod": {
			"description": "Default authentication method",
			"type": "string",
			"enum": ["none", "saml"],
			"default": "saml"
		},

		"welcomeFile": {
			"description": "Welcome file to be served when accessing the root path of the application",
			"type": "string",
			"default": "/index.html"
		},

		"sendWelcomeFileRedirect": {
			"description": "Determines if the server shall redirect the browser to the configured welcome file",
			"type": "boolean",
			"default": false
		},

		"logoutPage": {
			"description": "Path to the logout page. When requesting this page, a logout of the logged-in user is triggered.",
			"type": "string"
		},

		"routes": {
			"description": "Maps a client path to a destination, an HTML5 application or a service",
			"type": "array",
			"items": {
				"type": "object",
				"additionalProperties": false,
				"required": ["path", "target"],
				"properties": {
					"path": {
						"description": "Request path to be mapped to the route",
						"type": "string"
					},

					"target": {
						"description": "Target of requests that match the route path",
						"type": "object",
						"additionalProperties": false,
						"required": ["name"],
						"properties": {
							"type": {

								"description": "The type of the target this route forwards to",
								"type": "string",
								"enum": ["destination", "application", "service"],
								"default": "destination"
							},

							"name": {
								"description": "Name of the destination, application or service the route shall forward to",
								"type": "string"
							},

							"resolutionType": {
								"description": "Defines in case of a subscription if the destination or application is read from the subscribed account or from the account where the application is deployed to (Applicable for routings of type destination and application only",
								"type": "string",
								"enum": ["consumerAccount", "localAccount"],
								"default": "consumerAccount"
							},

							"entryPath": {
								"description": "Path to be prepended to the backend request",
								"type": "string"
							},

							"preferLocal": {
								"description": "If set to true, the route is only followed if no resource for the given path exists in the application itself (Applicable for routings of type application only)",
								"type": "boolean",
								"default": false
							},

							"version": {
								"description": "Version of the application or service the route shall forward to (Applicable for routings of type application and service only)",
								"type": "string"
							},

							"headerWhiteList": {
								"description": "Additional whitelisted header names for a destination route",
								"type": "array",
								"items": {
									"type": "string",
									"pattern": "^(?!(Content-Length|Cookie|Cookie2|Set-Cookie|Set-Cookie2)$).*$"
								}
							}
						}
					},

					"description": {
						"description": "Description of the route",
						"type": "string"
					}
				}
			}
		},

		"securityConstraints": {
			"description": "Enforces authentication and optionally authorization for a given path",
			"type": "array",
			"items": {
				"type": "object",
				"additionalProperties": false,
				"required": ["protectedPaths"],
				"properties": {
					"permission": {
						"description": "Name of the permission that is required to access the specified paths",
						"type": "string"
					},

					"description": {
						"description": "Description of the permission",
						"type": "string"
					},

					"protectedPaths": {
						"description": "Paths for which the security constraint applies",
						"type": "array",
						"items": {
							"type": "string"
						}
					},

					"excludedPaths": {
						"description": "Paths pattern that shall be excluded from the protection (e.g. \"/logout/**\"",
						"type": "array",
						"items": {
							"type": "string"
						}
					}
				}
			}
		},

		"cacheControl": {
			"description": "Cache control headers to be returned for resources served under the given paths",
			"type": "array",
			"items": {
				"type": "object",
				"additionalProperties": false,
				"properties": {
					"path": {
						"description": "Path pattern of the resources to be cached (e.g. \"**.html\")",
						"type": "string"
					},

					"directive": {
						"description": "Defines the HTTP Cache-Control directive to be set in resource responses",
						"type": "string",
						"enum": ["public", "private", "none"],
						"default": "none"
					},

					"maxAge": {
						"description": "Cache lifetime in seconds",
						"type": "integer"
					}
				}
			}
		},

		"headerWhiteList": {
			"description": "Whitelisted header names (applicable for routes of type destination)",
			"type": "array",
			"items": {
				"type": "string",
				"pattern": "^(?!(Content-Length|Cookie|Cookie2|Set-Cookie|Set-Cookie2)$).*$"
			}
		}
	}

}