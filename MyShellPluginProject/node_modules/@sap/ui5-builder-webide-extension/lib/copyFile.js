var EvoResource = require("@ui5/fs").Resource;
var fs = require('fs');
var path = require('path');
var TASK_MISSING_PARAMETERS = "Attributes srcFile or destFile are missing from configuration section of task.";

module.exports = async function({workspace, dependencies, options}) {
    await copyFile (options, workspace);
};

function copyFile(options, workspace) {
    if (options && options.configuration && options.configuration.srcFile && options.configuration.destFile) {
        var fileContent = fs.readFileSync(path.join(process.cwd(), options.configuration.srcFile));
        var resourceFileToWrite = createFile(fileContent, options.configuration.destFile);
        return workspace.write(resourceFileToWrite);
    } else {
        throw new Error (TASK_MISSING_PARAMETERS);
    }
}

function createFile(sContent, sPath){
    return new EvoResource({
        path: sPath,
        string: sContent});
}