'use strict';

var checkAuthorization = require('./authorization-handler');

module.exports = function authorizationCheck(req, res, next) {

  var authorizationResult = checkAuthorization (req);
  if (authorizationResult.isAuthorized) {
    next();
  } else {
    var error = new Error(authorizationResult.message);
    error.status = 403;
    next(error);
  }
};
